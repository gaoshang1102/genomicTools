#### fastq files downloaded from SRR sometimes have blank lines. Remove the blank lines first. ####

sed '/^$/d' myfav.fastq > myfav_remove_blank.fastq

#### remove the adapter with cutadapt ####
#### adapter usually is illumina universal adapter. Use Fastqc to verify the adapter. ####
#### Single end 
cutadapt -a AGATCGGAAGAGCACACGTCTGAACTCCAGTCA -j 10 -m 10 -o myfav_trimmed.fastq myfav_remove_blank.fastq

#### Paired end:
Please see the cutadapt documentation

#### bowtie2 ####

bowtie2 -p 20 -q --local -x /Shang_PHD/bowtie2_index/hg38/hg38 -U myfav_trimmed.fastq -S myfav_aln_unsorted.sam

#### filtering reads ####
#1,Change alignment file format from SAM to BAM
#2,Sort BAM file by read coordinate locations
#3,Filter to keep only uniquely mapping reads (this will also remove any unmapped reads)

samtools view -h -S -b -o myfav_aln_unsorted.bam myfav_aln_unsorted.sam

#### sambamba ####
# install #

wget https://github.com/biod/sambamba/releases/download/v0.6.8/sambamba-0.6.8-linux-static.gz
gunzip sambamba-0.6.8-linux-static.gz
chmod +x sambamba-0.6.8
#### 
./sambamba sort -t 2


